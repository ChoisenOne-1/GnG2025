<!doctype html>
<html lang="en">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Medical Help</title>
<style>
  body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; padding: 24px; }
  .card { max-width: 640px; margin: 0 auto; padding: 16px 20px; border: 1px solid #ddd; border-radius: 12px; }
  h1 { margin: 0 0 8px; font-size: 1.4rem; }
  #status { margin-top: 12px; color: #444; }
</style>
<body>
  <div class="card">
    <h1>Notifying the doctor‚Ä¶</h1>
    <p>This page will automatically send an alert. You can close it when it says <em>Sent</em>.</p>
    <div id="status">Sending‚Ä¶</div>
    <noscript><p style="color:#a00">This page needs JavaScript to send the alert.</p></noscript>
  </div>

<script>
const DISCORD_WEBHOOK_URL = "PASTE_YOUR_DISCORD_WEBHOOK_URL_HERE";
const SHARED_SECRET = ""; // optional; if set, add ?key=YOUR_SECRET to the link

(async () => {
  const set = (t) => document.getElementById('status').textContent = t;
  if (!DISCORD_WEBHOOK_URL || !/^https:\/\/discord\.com\/api\/webhooks\//.test(DISCORD_WEBHOOK_URL)) {
    set("Failed ‚ùå (Webhook URL missing)");
    return;
  }
  const p = new URLSearchParams(location.search);
  const key = p.get("key") || "";
  if (SHARED_SECRET && key !== SHARED_SECRET) return set("Failed ‚ùå (Invalid key)");
  const loc = p.get("loc") || "Conference Hall";
  const who = p.get("who") || "attendee";
  const now = new Date().toISOString();
  const content = ["üö® Medical help requested","Location: " + loc,"From: " + who,"Time (UTC): " + now].join("\n");
  try {
    const res = await fetch(DISCORD_WEBHOOK_URL, { method: "POST", headers: { "Content-Type": "application/json" }, body: JSON.stringify({ content }) });
    set(res.ok ? "Sent ‚úÖ" : "Failed ‚ùå (Discord HTTP " + res.status + ")");
  } catch { set("Failed ‚ùå (network error)"); }
})();
</script>
</body>
</html>
